{
    "query": "CREATE INDEX ON :Product(cdphId);"
}

{
    "query": "CCREATE INDEX ON :Product(csfId);"
}

{
    "query": "CREATE INDEX ON :Product(csf);"
}

{
    "query": "CREATE INDEX ON :Chemical(casId);"
}

{
    "query": "CREATE INDEX ON :Chemical(name);"
}

{
    "query": "CREATE INDEX ON :Category(name);"
}

{
    "query": "CREATE CONSTRAINT ON (c:Company) ASSERT c.name IS UNIQUE;"
}


{
    "query": "CREATE CONSTRAINT ON (c:Company) ASSERT c.id IS UNIQUE;"
}


{
    "query": "CREATE CONSTRAINT ON (b:Brand) ASSERT b.name IS UNIQUE;"
}


{
    "query": "CREATE CONSTRAINT ON (p:Product) ASSERT p.name IS UNIQUE;"
}


{
    "query": "CREATE CONSTRAINT ON (ch:Chemical) ASSERT ch.casNumber IS UNIQUE;"
}


{
    "query": "CREATE CONSTRAINT ON (c:Category) ASSERT c.id IS UNIQUE;"
}

{
    "query": "USING PERIODIC COMMIT 1000 LOAD CSV WITH HEADERS FROM 'https://gist.graphgrid.com/data/Chemicals_in_Cosmetics.csv' AS row WITH row LIMIT 1000 WHERE row.CompanyId IS NOT NULL and row.CompanyName IS NOT NULL and row.BrandName IS NOT NULL and row.ProductName IS NOT NULL and row.PrimaryCategory IS NOT NULL and row.PrimaryCategoryId IS NOT NULL and row.ChemicalName IS NOT NULL and row.CasId IS NOT NULL and row.CasNumber IS NOT NULL and row.SubCategoryId IS NOT NULL and row.SubCategory IS NOT NULL //Create Nodes MERGE (co:Company {id: row.CompanyId}) ON CREATE SET co.name = row.CompanyName MERGE (b:Brand {name: row.BrandName}) MERGE (p:Product {name: row.ProductName}) ON CREATE SET p.Id = row.ProductId, p.csfId = row.CSFId, p.csf = row.CSF, p.initialDateReported = row.InitialDateReported, p.mostRecentDateReported = row.MostRecentDateReported, p.discontinuedDate = row.DiscontinuedDate MERGE (ch:Chemical {casNumber: row.CasNumber}) ON CREATE SET ch.Id = row.CasId, ch.name = row.ChemicalName MERGE (c:Category {id: row.PrimaryCategoryId}) ON CREATE SET c.name = row.PrimaryCategory MERGE (s:Category {id: row.SubCategoryId}) ON CREATE SET s.name = row.SubCategory //Create Relationships MERGE (co)-[:OWNS]->(b) MERGE (b)-[:PRODUCES]->(p) MERGE (p)-[:BELONGS_TO]->(s) MERGE (c)-[:CONTAINS]->(s) MERGE (ch)-[r:USED_IN]->(p) //Set Properties on USED_IN Relationship ON CREATE SET r.chemicalCreatedOn = row.ChemicalCreatedAt, r.chemicalUpdatedOn = row.ChemicalUpdatedAt, r.dateChemicalRemoved = row.ChemicalDateRemoved, r.chemicalCount = toInt(row.ChemicalCount), r.chemicalId = row.ChemicalId; MATCH (co:Company)-[:OWNS]->(b:Brand {name: 'Revlon'}), (b)-[:PRODUCES]->(p:Product)-[:BELONGS_TO]->(s:Category)<-[:CONTAINS]-(c:Category), (ch:Chemical)-[:USED_IN]-(p) RETURN co, b, p, s, c, ch LIMIT 1;"
}